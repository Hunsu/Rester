{
   "name":"Prevoty XSS",
   "globals":{
      "variables":{
        "baseApiUrl":"https://api.prevoty.com",
        "api_key":"YOUR_KEY",
        "rule_key":"CONFIG_KEY"
      }
   },
   "testSteps":[
      {
         "name":"Prevoty Key Verification",
         "dumpResponse":"yes",
         "skip":"True",
         "apiUrl":"{baseApiUrl}/1/key/verify?api_key={api_key}",
         "assertMap": {
            "payLoad":{
              "verified":true,
              "message":"api_key is valid"
            }
         }
      },
      {
         "name":"XSS Basic test",
         "apiUrl":"{baseApiUrl}/1/xss/filter",
         "headers":{
            "content-type":"application/json;"
         },
         "method":"post",
         "params":{
            "api_key":"{api_key}",
            "input":"<script>Hello World!</script>",
            "rule_key":"{rule_key}"
         },
         "assertMap":{
              "headers":{
                "content-type":"application/json; charset=utf-8"
              },
              "payLoad":{
                "message":"",
                "output":"Hello World!",
                "statistics.javascript_tags":2,
                "statistics.transformations":2
              }
         }
      }
   ]
}
